<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
            background-color: #fafafa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .quick-start {
            background-color: #fff3e0;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #ff9800;
        }
        .urls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .url-item {
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
        }
        .url-item strong {
            color: #1976d2;
        }
        @media print {
            body {
                background-color: white;
            }
            .container {
                box-shadow: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>System Architecture</h1>
        
        <h2>Overview</h2>
        <div class="mermaid">
            graph TB
                subgraph "Frontend"
                    UI[React Dashboard<br/>Port 3002]
                end
                
                subgraph "Services"
                    CORE[Core Service<br/>Port 3000<br/>Product API]
                    ANALYTICS[Analytics Service<br/>Port 3003<br/>Event Processing]
                    NOTIFICATION[Notification Service<br/>Port 3001<br/>WebSocket]
                end
                
                subgraph "Infrastructure"
                    KAFKA[Kafka<br/>Port 9092]
                    POSTGRES[(PostgreSQL<br/>Port 5433)]
                    DYNAMODB[(DynamoDB<br/>Port 8000)]
                    MINIO[(MinIO<br/>Port 9000)]
                end
                
                UI --> CORE
                UI --> NOTIFICATION
                CORE --> KAFKA
                CORE --> POSTGRES
                KAFKA --> ANALYTICS
                KAFKA --> NOTIFICATION
                ANALYTICS --> DYNAMODB
                ANALYTICS --> MINIO
        </div>

        <h2>Event Flow</h2>
        <div class="mermaid">
            sequenceDiagram
                participant UI as Frontend
                participant CORE as Core Service
                participant KAFKA as Kafka
                participant ANALYTICS as Analytics
                participant NOTIFICATION as Notification
                
                UI->>CORE: Create Product
                CORE->>POSTGRES: Store Product
                CORE->>KAFKA: Emit Event
                CORE->>UI: Response
                
                par Event Processing
                    KAFKA->>ANALYTICS: Process Event
                    ANALYTICS->>DYNAMODB: Store Analytics
                and
                    KAFKA->>NOTIFICATION: Process Event
                    NOTIFICATION->>UI: Real-time Update
                end
        </div>

        <h2>Services</h2>
        <table>
            <thead>
                <tr>
                    <th>Service</th>
                    <th>Port</th>
                    <th>Purpose</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Core Service</td><td>3000</td><td>Product CRUD API</td></tr>
                <tr><td>Notification Service</td><td>3001</td><td>WebSocket notifications</td></tr>
                <tr><td>Frontend</td><td>3002</td><td>React dashboard</td></tr>
                <tr><td>Analytics Service</td><td>3003</td><td>Event processing</td></tr>
                <tr><td>Kafka</td><td>9092</td><td>Message broker</td></tr>
                <tr><td>PostgreSQL</td><td>5433</td><td>Product database</td></tr>
                <tr><td>DynamoDB</td><td>8000</td><td>Analytics data</td></tr>
                <tr><td>MinIO</td><td>9000</td><td>File storage</td></tr>
            </tbody>
        </table>

        <h2>Technology Stack</h2>
        <table>
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Technology</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><strong>Frontend</strong></td><td>React + TypeScript + Vite</td></tr>
                <tr><td><strong>Backend</strong></td><td>Node.js + Express + TypeScript</td></tr>
                <tr><td><strong>Event Bus</strong></td><td>Kafka</td></tr>
                <tr><td><strong>Databases</strong></td><td>PostgreSQL + DynamoDB</td></tr>
                <tr><td><strong>Storage</strong></td><td>MinIO (S3-compatible)</td></tr>
                <tr><td><strong>Real-time</strong></td><td>WebSocket</td></tr>
                <tr><td><strong>Orchestration</strong></td><td>Docker Compose</td></tr>
            </tbody>
        </table>

        <h2>Quick Start</h2>
        <div class="quick-start">
            <p><strong>Start System:</strong></p>
            <code>./start-dev.sh</code>
            
            <h3>Service URLs</h3>
            <div class="urls">
                <div class="url-item">
                    <strong>Frontend:</strong><br>
                    http://localhost:3002
                </div>
                <div class="url-item">
                    <strong>Core API:</strong><br>
                    http://localhost:3000
                </div>
                <div class="url-item">
                    <strong>Notifications:</strong><br>
                    http://localhost:3001
                </div>
                <div class="url-item">
                    <strong>Analytics:</strong><br>
                    http://localhost:3003
                </div>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            },
            sequence: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
    </script>
</body>
</html>